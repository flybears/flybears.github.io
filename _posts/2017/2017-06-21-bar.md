---
layout: "post"
title: "js操作符的运算规则"
date: "2017-06-28 16:47"
excerpt: "js操作符的运算规则"
tags: ["||", "|", "~", "&", "^", "<<", ">>"]
tech: true
comments: true
weather: sun
---


无意中在阮一峰的博客中看到了`|` 的使用，开始以为是`||`少写了个杠，后来网上查了下资料发现是自己孤陋寡闻了，所以特地写此篇博客记录下...
> 按位操作符（Bitwise operators） 将其操作数（operands）当作32位的比特序列（由0和1组成），而不是十进制、十六进制或八进制数值。例如，十进制数9，用二进制表示则为1001。按位操作符操作数字的二进制形式，但是返回值依然是标准的JavaScript数值。


## 按位或`|`
对每一对比特位执行或（OR）操作。如果 a 或 b 为 1，则 a OR b 结果为 1。或操作的真值表：

| a    | b    |  a AND b  |
| :--:  | :--:  | :--: |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 1 |

``` javascript
    console.log(5|6); //7
    console.log(5|5); //5
    console.log(7|3); //7
    console.log(5.3|4.1); //5
    console.log(9|3455); //3455
```

```javascript
    5|6 //二进制 101|110 = 111
    5|5 //二进制 101|101 = 101
    //下面以此类推
```
ps: 可以用来处理小数点取整


## 按位非`~`
对每一个比特位执行非（NOT）操作。NOT a 结果为 a 的反转（即反码）。非操作的真值表：

| a | NOT a |
| :--: | :--: |
| 0 | 1 |
| 1 | 0 |


``` javascript
    console.log(~5); // -6
```

```
    //5的二进制码
    0000 0000 0000 0000 0000 0000 0000 0101
    //~5的二进制码
    1111 1111 1111 1111 1111 1111 1111 1010

    //6的二进制原码
    0000 0000 0000 0000 0000 0000 0000 0110
    //6的二进制反码
    1111 1111 1111 1111 1111 1111 1111 1001
    //6的二进制补码（反码+1，-6）
    1111 1111 1111 1111 1111 1111 1111 1010
```

ps: 对任一数值 x 进行按位非操作的结果为 -(x + 1)。例如，~5 结果为 -6。


## 按位与`&`
对每对比特位执行与（AND）操作。只有 a 和 b 都是 1 时，a AND b 才是 1。与操作的真值表如下：

| a | b | a AND b |
| :--: | :--: | :--: |
| 0 | 0 | 0 |
| 0 | 1 | 0 |
| 1 | 0 | 0 |
| 1 | 1 | 1 |

例子略

ps: 将任一数值 x 与 0 执行按位与操作，其结果都为 0。将任一数值 x 与 -1 执行按位与操作，其结果都为 x。


## 按位异或`^`
对每一对比特位执行异或（XOR）操作。当 a 和 b 不相同时，a XOR b 的结果为 1。异或操作真值表：
| a | b | a AND b |
| :--: | :--: | :--: |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |

例子略

ps: 将任一数值 x 与 0 进行异或操作，其结果为 x。将任一数值 x 与 -1 进行异或操作，其结果为 ~x。


## 左移`<<`
该操作符会将第一个操作数向左移动指定的位数。向左被移出的位被丢弃，右侧用 0 补充。

``` javascript
    console.log(3<<2); //12
```

```
    //3的二进制码
    11
    //3<<2的二进制码
    1100
```

ps: 在数字 x 上左移 y 比特得到 x * 2y.


## 有符号右移`>>`
该操作符会将第一个操作数向右移动指定的位数。向右被移出的位被丢弃，拷贝最左侧的位以填充左侧。由于新的最左侧的位总是和以前相同，符号位没有被改变。所以被称作“符号传播”。

``` javascript
    console.log(9>>2); //2
    console.log(-9>>2); //-3
```

```
    //9的二进制码
    0000 0000 0000 0000 0000 0000 0000 1001
    //9>>2的二进制码
    0000 0000 0000 0000 0000 0000 0000 0010

    //-9的二进制码
    1111 1111 1111 1111 1111 1111 1111 0111
    //-9>>2的二进制码(-3)
    1111 1111 1111 1111 1111 1111 1111 1101
```


## 无符号右移`>>>`
该操作符会将第一个操作数向右移动指定的位数。向右被移出的位被丢弃，左侧用0填充。因为符号位变成了 0，所以结果总是非负的。（译注：即便右移 0 个比特，结果也是非负的。）

``` javascript
    console.log(9>>>2); //2
    console.log(-9>>>2); //1073741821
```

```
    //9的二进制码
    0000 0000 0000 0000 0000 0000 0000 1001
    //9>>2的二进制码
    0000 0000 0000 0000 0000 0000 0000 0010

    //-9的二进制码
    1111 1111 1111 1111 1111 1111 1111 0111
    //-9>>2的二进制码(-3)
    0011 1111 1111 1111 1111 1111 1111 1101
```


参考链接：<https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators>
